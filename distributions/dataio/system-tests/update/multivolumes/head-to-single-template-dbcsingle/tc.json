[
  {
    "name": "basis-update-head-to-single-template-dbcsingle",
    "description": "Omkatalogisering af en eksisterende hovedpost til enkeltstående post er ikke tilladt og skal fejle",
    "request": {
      "authentication": {
        "group": "010100",
        "user": "netpunkt",
        "password": "20Koster"
      },
      "templateName": "dbcsingle",
      "record": "request.marc"
    },
    "setup": {
      "rawrepo": [
        {
          "record": "rawrepo-aut-870979.marc",
          "type": "AUTHORITY",
          "deleted": false,
          "children": [
            "rawrepo-head-870970.marc"
          ],
          "enrichments": [
            "rawrepo-aut-191919.marc"
          ]
        },
        {
          "record": "rawrepo-aut-191919.marc",
          "type": "ENRICHMENT",
          "deleted": false
        },
        {
          "record": "rawrepo-head-870970.marc",
          "type": "MARCXCHANGE",
          "deleted": false,
          "children": [
            "rawrepo-bind-870970.marc"
          ],
          "enrichments": [
            "rawrepo-head-191919.marc"
          ]
        },
        {
          "record": "rawrepo-head-191919.marc",
          "type": "ENRICHMENT",
          "deleted": false
        },
        {
          "record": "rawrepo-bind-870970.marc",
          "type": "MARCXCHANGE",
          "deleted": false,
          "enrichments": [
            "rawrepo-bind-191919.marc"
          ]
        },
        {
          "record": "rawrepo-bind-191919.marc",
          "type": "ENRICHMENT",
          "deleted": false
        }
      ]
    },
    "expected": {
      "validation": {
        "errors": [
          {
            "type" : "ERROR",
            "code" : null,
            "urlForDocumentation" : "http://www.kat-format.dk/danMARC2/Danmarc2.7.htm",
            "ordinalPositionOfField" : 1,
            "ordinalPositionOfSubfield" : 1,
            "ordinalPositionInSubfield" : null,
            "message" : "Delfelt 004a må ikke ændre sig fra h til e"
          },
          {
            "type" : "ERROR",
            "code" : null,
            "urlForDocumentation" : "TODO:url",
            "ordinalPositionOfField" : null,
            "ordinalPositionOfSubfield" : null,
            "ordinalPositionInSubfield" : null,
            "message" : "Delfelt 008 *t er obligatorisk pga følgende delfelter: delfelt 008 *v med en af værdierne: 0,1,4"
          }
        ]
      },
      "update": {
        "errors": [
          {
            "type" : "ERROR",
            "code" : null,
            "urlForDocumentation" : "http://www.kat-format.dk/danMARC2/Danmarc2.7.htm",
            "ordinalPositionOfField" : 1,
            "ordinalPositionOfSubfield" : 1,
            "ordinalPositionInSubfield" : null,
            "message" : "Delfelt 004a må ikke ændre sig fra h til e"
          },
          {
            "type" : "ERROR",
            "code" : null,
            "urlForDocumentation" : "TODO:url",
            "ordinalPositionOfField" : null,
            "ordinalPositionOfSubfield" : null,
            "ordinalPositionInSubfield" : null,
            "message" : "Delfelt 008 *t er obligatorisk pga følgende delfelter: delfelt 008 *v med en af værdierne: 0,1,4"
          }
        ],
        "rawrepo": [
          {
            "record": "rawrepo-aut-870979.marc",
            "type": "AUTHORITY",
            "deleted": false,
            "children": [
              "rawrepo-head-870970.marc"
            ],
            "enrichments": [
              "rawrepo-aut-191919.marc"
            ]
          },
          {
            "record": "rawrepo-aut-191919.marc",
            "type": "ENRICHMENT",
            "deleted": false
          },
          {
            "record": "rawrepo-head-870970.marc",
            "type": "MARCXCHANGE",
            "deleted": false,
            "children": [
              "rawrepo-bind-870970.marc"
            ],
            "enrichments": [
              "rawrepo-head-191919.marc"
            ]
          },
          {
            "record": "rawrepo-head-191919.marc",
            "type": "ENRICHMENT",
            "deleted": false
          },
          {
            "record": "rawrepo-bind-870970.marc",
            "type": "MARCXCHANGE",
            "deleted": false,
            "enrichments": [
              "rawrepo-bind-191919.marc"
            ]
          },
          {
            "record": "rawrepo-bind-191919.marc",
            "type": "ENRICHMENT",
            "deleted": false
          }
        ]
      }
    }
  },
  {
    "name": "basis-update-head-to-single-template-dbchoved",
    "description": "Omkatalogisering af en eksisterende hovedpost til enkeltstående post er ikke tilladt og skal fejle",
    "request": {
      "authentication": {
        "group": "010100",
        "user": "netpunkt",
        "password": "20Koster"
      },
      "templateName": "dbchoved",
      "record": "request.marc"
    },
    "setup": {
      "rawrepo": [
        {
          "record": "rawrepo-aut-870979.marc",
          "type": "AUTHORITY",
          "deleted": false,
          "children": [
            "rawrepo-head-870970.marc"
          ],
          "enrichments": [
            "rawrepo-aut-191919.marc"
          ]
        },
        {
          "record": "rawrepo-aut-191919.marc",
          "type": "ENRICHMENT",
          "deleted": false
        },
        {
          "record": "rawrepo-head-870970.marc",
          "type": "MARCXCHANGE",
          "deleted": false,
          "children": [
            "rawrepo-bind-870970.marc"
          ],
          "enrichments": [
            "rawrepo-head-191919.marc"
          ]
        },
        {
          "record": "rawrepo-head-191919.marc",
          "type": "ENRICHMENT",
          "deleted": false
        },
        {
          "record": "rawrepo-bind-870970.marc",
          "type": "MARCXCHANGE",
          "deleted": false,
          "enrichments": [
            "rawrepo-bind-191919.marc"
          ]
        },
        {
          "record": "rawrepo-bind-191919.marc",
          "type": "ENRICHMENT",
          "deleted": false
        }
      ]
    },
    "expected": {
      "validation": {
        "errors": [
          {
            "type" : "ERROR",
            "code" : null,
            "urlForDocumentation" : "http://www.kat-format.dk/danMARC2/Danmarc2.7.htm",
            "ordinalPositionOfField" : 1,
            "ordinalPositionOfSubfield" : 1,
            "ordinalPositionInSubfield" : null,
            "message" : "Delfelt 004a må ikke ændre sig fra h til e"
          },
          {
            "type" : "ERROR",
            "code" : null,
            "urlForDocumentation" : "http://www.kat-format.dk/danMARC2/Danmarc2.7.htm",
            "ordinalPositionOfField" : 1,
            "ordinalPositionOfSubfield" : 1,
            "ordinalPositionInSubfield" : null,
            "message" : "Værdien 'e' i felt '004' delfelt 'a' er ikke en del af de valide værdier: 'h'"
          }
        ]
      },
      "update": {
        "errors": [
          {
            "type" : "ERROR",
            "code" : null,
            "urlForDocumentation" : "http://www.kat-format.dk/danMARC2/Danmarc2.7.htm",
            "ordinalPositionOfField" : 1,
            "ordinalPositionOfSubfield" : 1,
            "ordinalPositionInSubfield" : null,
            "message" : "Delfelt 004a må ikke ændre sig fra h til e"
          },
          {
            "type" : "ERROR",
            "code" : null,
            "urlForDocumentation" : "http://www.kat-format.dk/danMARC2/Danmarc2.7.htm",
            "ordinalPositionOfField" : 1,
            "ordinalPositionOfSubfield" : 1,
            "ordinalPositionInSubfield" : null,
            "message" : "Værdien 'e' i felt '004' delfelt 'a' er ikke en del af de valide værdier: 'h'"
          }
        ],
        "rawrepo": [
          {
            "record": "rawrepo-aut-870979.marc",
            "type": "AUTHORITY",
            "deleted": false,
            "children": [
              "rawrepo-head-870970.marc"
            ],
            "enrichments": [
              "rawrepo-aut-191919.marc"
            ]
          },
          {
            "record": "rawrepo-aut-191919.marc",
            "type": "ENRICHMENT",
            "deleted": false
          },
          {
            "record": "rawrepo-head-870970.marc",
            "type": "MARCXCHANGE",
            "deleted": false,
            "children": [
              "rawrepo-bind-870970.marc"
            ],
            "enrichments": [
              "rawrepo-head-191919.marc"
            ]
          },
          {
            "record": "rawrepo-head-191919.marc",
            "type": "ENRICHMENT",
            "deleted": false
          },
          {
            "record": "rawrepo-bind-870970.marc",
            "type": "MARCXCHANGE",
            "deleted": false,
            "enrichments": [
              "rawrepo-bind-191919.marc"
            ]
          },
          {
            "record": "rawrepo-bind-191919.marc",
            "type": "ENRICHMENT",
            "deleted": false
          }
        ]
      }
    }
  }
]
